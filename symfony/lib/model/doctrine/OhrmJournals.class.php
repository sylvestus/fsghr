<?php

/**
 * OhrmJournals
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    orangehrm
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class OhrmJournals extends BaseOhrmJournals
{
    
    public  function journal_entry($data){


		$trans_no = $this->getTransactionNumber();


		// function for crediting

		$this->creditAccount($data, $trans_no);

		// function for crediting

		$this->debitAccount($data, $trans_no);

		
	}



	public function getTransactionNumber(){

		$date = date('Y-m-d H:m:s');

		$trans_no  = strtotime($date);

		return $trans_no;
	}


	public function creditAccount($data, $trans_no){

		$journal = new OhrmJournals();

		$account = OhrmAccountsTable::getAccountById($data['credit_account']);
          
$journal->setAccountId($account->id);

		$journal->setDate($data['date']);
		$journal->setTransNo($trans_no);
		$journal->setInitiatedBy($data['initiated_by']);
		$journal->setAmount($data['amount']);
		$journal->setType('credit');
		$journal->setDescription($data['description']);
                $journal->setCreatedAt(date("Y-m-d H:i:s"));
                $journal->setUpdatedAt(date("Y-m-d H:i:s"));
		$journal->save();
	}



	public function debitAccount($data, $trans_no){

		$journal = new OhrmJournals();


$account = OhrmAccountsTable::getAccountById($data['debit_account']);

$journal->setAccountId($account->getId());

		$journal->setDate($data['date']);
		$journal->setTransNo($trans_no);
		$journal->setInitiatedBy($data['initiated_by']);
		$journal->setAmount($data['amount']);
		$journal->setType('credit');
		$journal->setDescription($data['description']);
                $journal->setCreatedAt(date("Y-m-d H:i:s"));
                $journal->setUpdatedAt(date("Y-m-d H:i:s"));
		$journal->save();
	}
}
