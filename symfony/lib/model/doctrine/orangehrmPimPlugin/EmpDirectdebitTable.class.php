<?php

/**
 * EmpDirectdebitTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class EmpDirectdebitTable extends PluginEmpDirectdebitTable
{
    /**
     * Returns an instance of this class.
     *
     * @return object EmpDirectdebitTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('EmpDirectdebit');
    }
    
      public static function  getEmployeeBankAndBranch($empno){
      
             $q = Doctrine_Query::create()
                            ->from('EmpDirectdebit')
                         ->where(" `emp_number`=$empno");
             $q->execute();
             $result=$q->fetchOne();
      if(is_object($result)){
          $branch= OhrmBankBranchTable::getBranchById($result->getBankBranch());
          $bankandbranch=  OhrmBankBranchTable::getBankFromBranch($result->getBankBranch());
          $bankdetails=  Ohrm_BankTable::getBankById($branch->getBankId());
          return array("bankandbranch"=> $bankandbranch,"account_number"=>$result->getAccount(),"branchcode"=>$branch->getBranchCode(),"branchname"=>$branch->getBranchName(),"bankname"=>$bankdetails->getBankName(),"bankcode"=>$bankdetails->getBankCode()) ;        
      }
 else {
          return NULL;    
      }
     
    }
    
}